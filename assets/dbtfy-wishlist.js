customElements.get("dbtfy-wishlist-badge")||customElements.define("dbtfy-wishlist-badge",class extends HTMLElement{constructor(){super(),this.url=Debutify.removeLocalFromUrl(this.dataset.productUrl).split("?")[0],this.icon=this.querySelector("i"),this.checked=!1}connectedCallback(){Debutify.settings?.dbtfy_wish_list||Shopify.designMode?(subscribe(PUB_SUB_EVENTS.wishlistUpdate,(({url:t,checked:e})=>{t===this.url&&(e?this.active():this.inactive())})),Debutify.wishlist.includes(this.url)&&(this.active(),this.checked=!0),this.addEventListener("click",this.toggle)):this.remove()}toggle(){this.checked?(this.inactive(),Debutify.wishlist=Debutify.wishlist.filter((t=>t!==this.url))):(this.active(),Debutify.wishlist.push(this.url)),localStorage.setItem("dbtfy-wishlist",JSON.stringify(Debutify.wishlist)),publish(PUB_SUB_EVENTS.wishlistUpdate,{url:this.url,checked:this.checked})}active(){this.classList.add("active"),this.checked=!0}inactive(){this.classList.remove("active"),this.checked=!1}}),customElements.get("dbtfy-wishlist-drawer")||customElements.define("dbtfy-wishlist-drawer",class extends HTMLElement{constructor(){super(),this.items=[],this.itemsContainer=this.querySelector(".dbtfy-wishlist--items"),this.testMode=Shopify.designMode}disconnectedCallback(){this.testMode&&(this.deselectEvent(),this.selectEvent())}connectedCallback(){if(this.testMode)this.deselectEvent=subscribe(PUB_SUB_EVENTS.shopifyEventSectionSelect,(t=>{"dbtfy-wishlist-drawer"===t.detail.sectionId&&this.parentElement.open()})),this.selectEvent=subscribe(PUB_SUB_EVENTS.shopifyEventSectionDeselect,(t=>{"dbtfy-wishlist-drawer"===t.detail.sectionId&&this.parentElement.close()}));else if(!Debutify.settings?.dbtfy_wish_list)return void this.remove();document.querySelectorAll(".header__icon--wishlist").forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),this.parentElement.open()}))})),this.init(),subscribe(PUB_SUB_EVENTS.wishlistUpdate,(async({url:t,checked:e})=>{e?await this.addItem(t):this.removeItem(t)}))}init(){const t=Debutify.wishlist.map((async t=>{await this.fetchItem(t)}));Promise.all(t).then((()=>{this.updateDrawer()}))}updateDrawer(){this.itemsContainer.innerHTML="",this.items.forEach((({html:t})=>{const e=document.createElement("div");e.classList.add("grid__item"),e.innerHTML=t,this.itemsContainer.appendChild(e)})),this.drawer_title=this.querySelector(".dbtfy-drawer__heading").attributes["data-title"].value,0==this.items.length?this.classList.add("dbtfy-wishlist_drawer_empty"):this.items.length>0&&this.classList.remove("dbtfy-wishlist_drawer_empty"),this.draweCount()}draweCount(){this.drawer_title.includes("count")&&(this.querySelector(".dbtfy-drawer__heading").innerHTML=this.drawer_title.replaceAll("{count}",this.items.length))}removeItem(t){this.items=this.items.filter((e=>e.url!==t)),this.updateDrawer()}async addItem(t){await this.fetchItem(t),this.updateDrawer()}async fetchItem(t){try{let e=await Debutify.fetchProductMarkup(`${t}?view=internal-wishlist`);if(!e)return null;this.items.push({url:t,html:e})}catch(t){return console.error("Error: "+t),null}}}),customElements.get("dbtfy-wishlist-count")||customElements.define("dbtfy-wishlist-count",class extends HTMLElement{constructor(){super()}connectedCallback(){Debutify.settings?.dbtfy_wish_list||Shopify.designMode?(this.wishlistBubblecount(),subscribe(PUB_SUB_EVENTS.wishlistUpdate,(({url:t,checked:e})=>{this.wishlistBubblecount()}))):this.remove()}wishlistBubblecount(){this.querySelector("span")&&(this.querySelector("span").innerHTML=Debutify.wishlist.length)}}),customElements.get("dbtfy-wishlist")||customElements.define("dbtfy-wishlist",class extends HTMLElement{constructor(){super(),this.items=[],this.itemsContainer=this.querySelector(".dbtfy-wishlist-section--items"),this.sliderTemplate=this.querySelector("#wishlist-slider"),this.productToShow=this.dataset.productToShow}connectedCallback(){Debutify.settings?.dbtfy_wish_list||Shopify.designMode?(this.updateWishistlistCount(),this.init(),subscribe(PUB_SUB_EVENTS.wishlistUpdate,(async({url:t,checked:e})=>{this.updateWishistlistCount(),e?await this.addItem(t):this.removeItem(t)}))):this.remove()}updateWishistlistCount(){Debutify.wishlist.length>0?this.classList.contains("dbtfy-wishlist--has-items-empty")&&this.classList.remove("dbtfy-wishlist--has-items-empty"):this.classList.add("dbtfy-wishlist--has-items-empty")}init(){const t=Debutify.wishlist.map((async t=>{await this.fetchItem(t)}));Promise.all(t).then((()=>{this.updateWishlistSection()}))}updateWishlistSection(){const t=(new DOMParser).parseFromString(this.sliderTemplate.innerHTML,"text/html");let e=t.querySelector(".dbtfy-wishlist-section--items");this.items.forEach((({html:t},i)=>{if(i>=this.productToShow)return;const s=document.createElement("div");s.classList.add("grid__item"),s.id=`Slide-${i}`,s.innerHTML=t,e.appendChild(s)})),this.querySelector("dbtfy-slider-component")?.classList.add("hidden"),this.querySelector(".loading__spinner").classList.remove("hidden"),setTimeout((()=>{this.querySelector(".loading__spinner").classList.add("hidden"),this.querySelector("dbtfy-slider-component")?.remove();let e=t.querySelector("dbtfy-slider-component");this.sliderTemplate.insertAdjacentElement("afterend",e),this.querySelector("dbtfy-slider-component").classList.remove("hidden")}),1e3)}removeItem(t){this.items=this.items.filter((e=>e.url!==t)),this.updateWishlistSection()}async addItem(t){await this.fetchItem(t),this.updateWishlistSection()}async fetchItem(t){try{let e=await Debutify.fetchProductMarkup(`${t}?view=internal-wishlist`);if(!e)return null;this.items.push({url:t,html:e})}catch(t){return console.error("Error: "+t),null}}});