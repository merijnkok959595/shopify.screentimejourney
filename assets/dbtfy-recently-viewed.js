customElements.get("dbtfy-recently-viewed-badge")||customElements.define("dbtfy-recently-viewed-badge",class extends HTMLElement{constructor(){super(),this.url=Debutify.removeLocalFromUrl(this.dataset.productUrl).split("?")[0],this.icon=this.querySelector("i"),this.checked=!1}connectedCallback(){subscribe(PUB_SUB_EVENTS.recentlyUpdated,(({url:e,checked:t})=>{e===this.url&&(t?this.active():this.inactive())})),Debutify.recentlyViewed.includes(this.url)&&(this.active(),this.checked=!0),this.toggle()}toggle(){this.checked||(this.active(),Debutify.recentlyViewed.push(this.url)),localStorage.setItem("dbtfy-recently-viewed",JSON.stringify(Debutify.recentlyViewed)),publish(PUB_SUB_EVENTS.recentlyUpdated,{url:this.url,checked:this.checked})}active(){this.classList.add("active"),this.checked=!0}inactive(){this.classList.remove("active"),this.checked=!1}}),customElements.get("dbtfy-recently-viewed")||customElements.define("dbtfy-recently-viewed",class extends HTMLElement{constructor(){super(),this.items=[],this.itemsContainer=this.querySelector(".dbtfy-recently-viewed-section--items"),this.sliderTemplate=this.querySelector("#recently-viewed-slider"),this.productToShow=this.dataset.productToShow,this.imageRatio=`media-${this.dataset.imageRatio}`}connectedCallback(){this.updateWishistlistCount(),this.init(),subscribe(PUB_SUB_EVENTS.recentlyUpdated,(async({url:e,checked:t})=>{this.updateWishistlistCount(),t&&await this.addItem(e)}))}updateWishistlistCount(){Debutify.recentlyViewed.length>0?this.classList.contains("dbtfy-recently-viewed--has-items-empty")&&this.classList.remove("dbtfy-recently-viewed--has-items-empty"):this.classList.add("dbtfy-recently-viewed--has-items-empty")}init(){const e=Debutify.recentlyViewed.map((async e=>{e.includes("products")&&await this.fetchItem(e)}));Promise.all(e).then((()=>{this.recentlyViewedSection()}))}recentlyViewedSection(){const e=(new DOMParser).parseFromString(this.sliderTemplate.innerHTML,"text/html");let t=e.querySelector(".dbtfy-recently-viewed-section--items");this.items.forEach((({html:e},i)=>{if(i>=this.productToShow)return;const s=document.createElement("div");s.classList.add("grid__item"),s.id=`Slide-${i}`,s.innerHTML=e,t.appendChild(s)}));let i=e.querySelector("dbtfy-slider-component");i.querySelectorAll(".grid__item .card-wrapper").forEach((e=>{e.querySelector(".card").classList.add("image--ratio"),e.querySelectorAll(".card__media .media").forEach((e=>{e.classList.add(this.imageRatio)}))})),this.sliderTemplate.insertAdjacentElement("afterend",i)}removeItem(e){this.items=this.items.filter((t=>t.url!==e)),this.recentlyViewedSection()}async addItem(e){await this.fetchItem(e),this.recentlyViewedSection()}async fetchItem(e){try{let t=await Debutify.fetchProductMarkup(`${e}?view=internal-recently-viewed`);if(!t)return null;this.items.push({url:e,html:t})}catch(e){return console.error("Error: "+e),null}}});