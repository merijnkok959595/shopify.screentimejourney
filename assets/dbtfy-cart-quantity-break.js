customElements.get("cart-quantity-break")||customElements.define("cart-quantity-break",class extends HTMLElement{constructor(){super(),this.cartQTYBreak=document.querySelector("dbtfy-cart-quantity-break"),this.data=Debutify.widgets["qty-breaks"]}connectedCallback(){this.cartQTYBreak&&(this.itemCount=Number(this.dataset.itemCount),this.breaks=this.cartQTYBreak.querySelectorAll(".dbtfy-cart-quantity-break"),this.highestDiscount=this.cartQTYBreak.querySelector(".dbtfy-cart-quantity-break__highest-discount"),this.breaks.length>0&&this.renderBreak(this.itemCount))}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber()}renderBreak(t){var e="";let r=null;if(t>0){for(let a=0;a<this.breaks.length;a++){const s=this.breaks[a],c=this.data.text,i=Number(s.dataset.range),o=s.dataset.discount.trim();if(i>t&&!e){const r=i-t;e=c.replace("{count}",r).replace("{discount}",o);break}r=s}if(r){const t=r.dataset.discountCode.trim(),e=localStorage.getItem("cart_break_discount_code");t&&t!=e&&(localStorage.setItem("cart_break_discount_code",t),fetch(`/discount/${t}`,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((t=>{t.ok||console.error("Failed to apply discount: "+t.statusText)})).catch((t=>{console.error("Error applying discount:",t)})).finally((()=>{"page"===Debutify.settings.cart_type?window.location.reload():"drawer"===Debutify.settings.cart_type&&fetch(`${routes.cart_url}?section_id=cart-drawer`).then((t=>t.text())).then((t=>{const e=(new DOMParser).parseFromString(t,"text/html").querySelector("#shopify-section-cart-drawer #CartDrawer");document.querySelector("#shopify-section-cart-drawer #CartDrawer").replaceWith(e)})).catch((t=>{console.error(t)}))})))}e||(e=this.data.highest_discount_text)}const a=this.querySelector(".dbtfy-cart-break");a&&(a.querySelector("span").innerHTML=e)}});