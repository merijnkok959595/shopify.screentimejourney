customElements.get("dbtfy-cart-delivery-time")||customElements.define("dbtfy-cart-delivery-time",class extends HTMLElement{constructor(){super(),this.data=Debutify.widgets["dbtfy-delivery-time"],this.data&&this.data.dbtfy_delivery_time_heading?this.init():this.remove()}init(){this.data.dbtfy_delivery_time_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!1,checkoutButtonHandler());const{Calendar:t}=window.VanillaCalendarPro;this.deliveryTimeInput=this.querySelector(".dbtfy-cart-delivery-time"),this.calendar=new t(this.deliveryTimeInput,this.getTimeOptions()),this.calendar.init(),this.timeShow=this.querySelector(".dbtfy-cart-delivery-time-show"),this.populateTime()}populateTime(){const t=Debutify.cart?.attributes?.delivery_time||"";t&&(this.timeShow.textContent=t,this.data.dbtfy_delivery_time_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!0,checkoutButtonHandler()))}getTimeOptions(){const t=Debutify.cart?.attributes?.delivery_time||"",e=this;return this.data.dbtfy_delivery_time_min?this.data.dbtfy_delivery_time_min=Math.abs(this.data.dbtfy_delivery_time_min):this.data.dbtfy_delivery_time_min=0,this.data.dbtfy_delivery_time_max?this.data.dbtfy_delivery_time_max=Math.abs(this.data.dbtfy_delivery_time_max):this.data.dbtfy_delivery_time_max=23,{layouts:{default:"<#ControlTime />"},selectedTheme:"light",timeMinHour:this.data.dbtfy_delivery_time_min,timeMaxHour:this.data.dbtfy_delivery_time_max,selectionTimeMode:12,selectedTime:t,onChangeTime(t){e.updateCartDeliveryTime(t.context.selectedTime)}}}async updateCartDeliveryTime(t){const e={attributes:{delivery_time:t}};this.abortController&&this.abortController.abort(),this.abortController=new AbortController;try{const i=await fetch(`${window.routes.cart_update_url}.js`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:this.abortController.signal}),a=await i.json();publish(PUB_SUB_EVENTS.cartUpdate,{source:"cart-items",cartData:a}),this.timeShow.textContent=t,this.data.dbtfy_delivery_time_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!0,checkoutButtonHandler())}catch(t){"AbortError"!==t.name&&console.error("Error updating cart:",t)}}});