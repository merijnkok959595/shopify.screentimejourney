customElements.get("dbtfy-sales-popup")||customElements.define("dbtfy-sales-popup",class extends HTMLElement{constructor(){super(),this.blockId=this.dataset.blockId,this.customerNames=this.dataset.customerNames.split(","),this.cityNames=this.dataset.cityNames.split(","),this.closeIcon=this.dataset.closeIcon,this.colorScheme=this.dataset.colorScheme,this.customColorScheme=this.dataset.customColorScheme,this.templateStyle=this.dataset.templateStyle,this.imageShape=this.dataset.productImageShape,this.imageRadius=this.dataset.productImageRadius,this.position=this.dataset.position,this.positionMobile=this.dataset.positionMobile,this.displayTime=1e3*Number(this.dataset.displayTime),this.delayTime=1e3*Number(this.dataset.delayTime),this.queue="true"===this.dataset.queue,this.notification="true"===this.dataset.notification,this.popups=this.querySelectorAll(".dbtfy-sales-popup"),this.queue||(this.delayTime=this.displayTime+500),this.testMode=Shopify.designMode,this.selectEvent=null,this.deselectEvent=null}disconnectedCallback(){this.toast?.destroyToast(),clearInterval(this.popupInterval),this.testMode&&(this.selectEvent(),this.deselectEvent())}connectedCallback(){if(this.testMode)this.selectEvent=subscribe(PUB_SUB_EVENTS.salesPopupSelect,(t=>{this.updatePopup()})),this.deselectEvent=subscribe(PUB_SUB_EVENTS.salesPopupDeselect,(t=>{this.toast?.hideToast()}));else{if(localStorage.getItem("hide_sales_popup"))return;this.popupInterval=setInterval((()=>{this.updatePopup()}),this.delayTime)}}updatePopup(){const t=this.getRandomPopup();if(!t||localStorage.getItem("hide_sales_popup"))return;if(this.notification){new Audio("https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3").play().catch((t=>{console.error("Error playing audio:",t)}))}let e=this.position;switch(window.innerWidth<=767&&(e=this.positionMobile),this.toast=new Debutify.toast(t.outerHTML,{position:e,duration:this.testMode?null:this.displayTime,closeIcon:this.closeIcon,colorScheme:this.colorScheme,customColorScheme:this.customColorScheme}),this.toast.toastContainer.querySelectorAll(".dbtfy-sales-popup__link").forEach((t=>{t.onclick=()=>{localStorage.setItem("hide_sales_popup",!0)}})),"circle"!=this.imageShape&&(this.toast.toastElement.querySelector("img").style.borderRadius=`${this.imageRadius}px`,this.toast.toastElement.querySelector(".global-media-settings").style.borderRadius=`${this.imageRadius}px`),this.templateStyle){case"square":this.toast.toastElement.style.borderRadius="0";break;case"radius-edge":this.toast.toastElement.style.borderRadius=`${Debutify.settings.popup_corner_radius}px`;break;case"round":this.toast.toastElement.style.borderRadius="100px",this.toast.toastElement.querySelector(".dbtfy-toast-close").style.marginTop="30px",this.toast.toastElement.querySelector(".dbtfy-toast-close").style.marginRight="15px";break;case"round-square":this.toast.toastElement.style.borderTopLeftRadius=this.toast.toastElement.offsetHeight/2+"px",this.toast.toastElement.style.borderBottomLeftRadius=this.toast.toastElement.offsetHeight/2+"px"}}getRandomPopup(){const t=this.customerNames[Math.floor(Math.random()*this.customerNames.length)],e=this.cityNames[Math.floor(Math.random()*this.cityNames.length)],s=this.popups[Math.floor(Math.random()*this.popups.length)],i=s.querySelector(".dbtfy-sales-popup__customer-info"),o=i.dataset.text.trim().replace("{CUSTOMER}",t).replace("{CITY}",e);return i.textContent=o,s}});