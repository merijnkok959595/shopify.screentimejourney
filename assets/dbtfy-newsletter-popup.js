customElements.get("dbtfy-newsletter-popup-sidebar")||customElements.define("dbtfy-newsletter-popup-sidebar",class extends HTMLElement{constructor(){super(),this.sideBar=this.querySelector(".dbtfy-newsletter-popup-sidebar"),this.sideBarButton=this.querySelector(".dbtfy-newsletter-popup-sidebar button"),this.selector=this.dataset.selector,this.modalWidth=this.dataset.modalWidth,this.activateModal=this.dataset.activateModal,this.activateModalSecondary=this.dataset.activateModalSecondary,this.time=1e3*this.dataset.time,this.scroll=this.dataset.scrollWidth,this.closeButtonSelector=this.dataset.closeButtonSelector,this.copyButtonSelector=this.dataset.copyButtonSelector,this.copyButtonValue=this.dataset.copyButtonValue,this.sidebarEnabled=this.dataset.sidebarEnabled,this.close_icon_hide=this.dataset.closeIconHide}connectedCallback(){this.designMode=Shopify.designMode,this.closeMethods=["overlay","button","escape"],"/challenge"!==window.location.pathname&&(window.matchMedia("(max-width: 540px)").matches&&"false"===this.close_icon_hide&&(this.closeMethods=["overlay","escape"]),document.addEventListener("DOMContentLoaded",(()=>{this.modal=new Debutify.modal({closeMethods:this.closeMethods,size:this.modalWidth,closeIcon:"close",selector:"dbtfy-newsletter-popup",boxClass:[],overlayClass:["dbtfy-newsletter-popup-overlay"],onOpen:function(){},onClose:function(){}})})),this.designMode||this.storageValue())}setupModalEvent(t){"after_x_sec"===t?this.timeStart():"scroll_depth"===t?this.windowScroll():"leaving_store"===t?this.exitIntentTrigger():"page_load"===t&&this.modal.open()}storageValue(){setTimeout((()=>{"true"===localStorage.getItem("dbtfyNewsletterPopup")?this.modal?.close():(this.setupModalEvent(this.activateModal),this.activateModal!=this.activateModalSecondary&&this.activateModalSecondary&&this.setupModalEvent(this.activateModalSecondary)),this.sidebarEnabled&&this.newsletterSidebar(),this.copyButton(),this.closeButtonEvent()}),500)}closeButtonEvent(){const t=this.modal.modalBox.querySelector(this.closeButtonSelector);t&&(t.onclick=()=>{this.modal.close(),localStorage.setItem("dbtfyNewsletterPopup","true")})}exitIntentTrigger(){document.addEventListener("mouseleave",(t=>{t.clientY<=0&&"true"!==localStorage.getItem("dbtfyNewsletterPopup")&&this.modal.open()}))}newsletterSidebar(){this.sideBarButton?.addEventListener("click",(t=>{this.modal.open()}))}copyButton(){if(this.copyButtonValue){const t=this.modal?.modalBox.querySelector(this.copyButtonSelector);t&&(t.onclick=()=>{navigator.clipboard.writeText(this.copyButtonValue),this.modal.close(),fetch(`/discount/${this.copyButtonValue}`,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((t=>{t.ok||console.error("Failed to apply discount: "+t.statusText)})).catch((t=>{console.error("Error applying discount:",t)})).finally((()=>{localStorage.setItem("dbtfy-cart-discount",this.copyButtonValue)}))})}}windowScroll(){let t=!1;window.addEventListener("scroll",(()=>{if(!t){const e=document.documentElement.scrollHeight||document.body.scrollHeight;(document.documentElement.scrollTop||document.body.scrollTop)/(e-(document.documentElement.clientHeight||document.body.clientHeight))*100>this.scroll&&(this.modal.open(),t=!0)}}))}timeStart(){setTimeout((()=>{this.modal.open()}),this.time)}});