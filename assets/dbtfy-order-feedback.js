customElements.get("order-feedback")||customElements.define("order-feedback",class extends HTMLElement{constructor(){super(),this.data=Debutify.widgets["dbtfy-order-feedback"],this.event=!!this.data&&this.dataGet(),this.cartFetch(),this.selectElement=this.querySelector(".order-feedback-select"),this.inputElement=this.querySelector(".order-feedback-input"),this.orderFeedback=this.querySelector(".dbtfy-order-feedback-show"),this.required=this.data.dbtfy_order_feedback_required,this.required&&(void 0===Debutify.cart.attributes[this.data.dbtfy_order_feedback_question]?Debutify.checkout["dbtfy-order-feedback"]=!1:Debutify.checkout["dbtfy-order-feedback"]=!0,checkoutButtonHandler(),this.selectElement.addEventListener("change",(()=>{Debutify.checkout["dbtfy-order-feedback"]=!0,checkoutButtonHandler()})))}dataGet(){const e=this.querySelector("#order-feedback-select"),t=this.data.dbtfy_order_feedback_option;if(""!==t){var i=t.split(",");i.forEach((t=>{const i=document.createElement("option");i.value=t.toLowerCase(),i.textContent=t,e.appendChild(i)}))}return!!(i&&i.length>0&&this.data.dbtfy_order_feedback_question)}connectedCallback(){this.event?this.selectElement.addEventListener("change",this.toggleInput.bind(this)):this.remove()}cartFetch(){setTimeout((()=>{Debutify.cart.attributes[this.data.dbtfy_order_feedback_question]&&(this.orderFeedback.textContent=this.capitalizeEachWord(Debutify.cart.attributes[this.data.dbtfy_order_feedback_question]),this.selectElement.querySelector('option[value="'+Debutify.cart.attributes[this.data.dbtfy_order_feedback_question]+'"]')?(this.selectElement.value=Debutify.cart.attributes[this.data.dbtfy_order_feedback_question],this.orderFeedback.textContent=this.capitalizeEachWord(Debutify.cart.attributes[this.data.dbtfy_order_feedback_question])):(this.orderFeedback.textContent="Other",this.selectElement.value="other",this.inputElement.value=Debutify.cart.attributes[this.data.dbtfy_order_feedback_question],this.inputElement.classList.remove("hidden"),this.inputElement.focus(),this.inputElement.addEventListener("input",this.logInputValue.bind(this))))}),100)}capitalizeEachWord(e){return e.replace(/\b\w/g,(e=>e.toUpperCase()))}toggleInput(){const e=this.selectElement.value.trim();this.orderFeedback.textContent=this.capitalizeEachWord(e),"other"===e.toLowerCase()?(this.inputElement.classList.remove("hidden"),this.inputElement.focus(),this.inputElement.addEventListener("input",this.logInputValue.bind(this))):(this.inputElement.classList.add("hidden"),this.updateCartFeedback(e))}logInputValue(){setTimeout((()=>{const e=this.inputElement.value;this.updateCartFeedback(e)}),1e3)}async updateCartFeedback(e){const t={attributes:{[this.data.dbtfy_order_feedback_question]:e}};try{await fetch(`${window.routes.cart_update_url}.js`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(e){console.error("Error updating cart:",e)}}});