customElements.get("dbtfy-add-on-cart")||customElements.define("dbtfy-add-on-cart",class extends HTMLElement{constructor(){super(),this.data=Debutify.widgets["dbtfy-add-on-cart"],this.switchInput=this.querySelector(".switch input"),this.setupProductData(),this.showProductInCart=this.data.show_product_in_cart,this.cart=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),this.cartUpdateUnsubscriber=null}setupProductData(){if(!this.data.product)return this.remove(),!1}removeEventListeners(){this.cartUpdateUnsubscriber()}connectedCallback(){this.switchInput.addEventListener("change",this.changeCheckbox.bind(this)),this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,(t=>{if(0==Debutify.widgets["dbtfy-add-on-cart"].show_product_in_cart&&"cart-items"===t.source&&this.switchInput.checked&&1==Debutify.cart.items.length&&Debutify.cart.items[0].id==this.dataset.id){this.switchInput.checked=!1;const t=new Event("change");this.switchInput.dispatchEvent(t)}this.cartUpdateUnsubscriber&&this.removeEventListeners()}))}changeCheckbox(){this.switchInput.checked?this.submitAddOnCartProduct():this.removeAddOnCartProduct()}removeAddOnCartProduct(){const t=this.dataset.id,e=JSON.stringify({id:t,quantity:0,sections:document.querySelector("cart-drawer-items").getSectionsToRender().map((t=>t.section)),sections_url:window.location.pathname});fetch(`${routes.cart_change_url}`,{...fetchConfig(),body:e}).then((t=>t.text())).then((e=>{const s=JSON.parse(e);s.item_count||this.cart.classList.add("is-empty"),publish(PUB_SUB_EVENTS.cartUpdate,{source:"add-on-cart",cartData:s,variantId:t}),publish(PUB_SUB_EVENTS.cartUpdate,{source:"cart-items",cartData:s,variantId:t}),this.cart.renderContents(s,Debutify.settings.cart_type_action)})).catch((t=>{console.error("Error:",t)}))}submitAddOnCartProduct(){const t=Number(this.dataset.id);Debutify.ajaxAddToCart({id:t,quantity:1,"properties[_addOnCart]":!0,"properties[_showProduct]":this.showProductInCart})}});